<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberGuard AI | Next-Gen Threat Intel</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/notification_system.js"></script>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon"></div>
                <h1>CyberGuard AI</h1>
            </div>
            <nav>
                <ul id="mainNav">
                    <li class="active" data-module="overview"><span class="nav-icon">üìä</span> Overview</li>
                    <li data-module="matrix"><span class="nav-icon">üõ°Ô∏è</span> Threat Matrix</li>
                    <li data-module="investigation"><span class="nav-icon">üîç</span> Investigation</li>
                    <li data-module="map"><span class="nav-icon">üåê</span> Network Map</li>
                    <li data-module="cloud"><span class="nav-icon">‚òÅÔ∏è</span> Cloud Security</li>
                    <li data-module="compliance"><span class="nav-icon">‚öñÔ∏è</span> Compliance</li>
                    <li data-module="settings"><span class="nav-icon">‚öôÔ∏è</span> Settings</li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <div class="pulse-container">
                    <p>Security Pulse: <span id="pulseValue">100%</span></p>
                    <div class="progress-track">
                        <div id="pulseBar" class="progress-fill"></div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header>
                <div class="header-left">
                    <h2 id="moduleTitle">SOC Operations Center</h2>
                    <p class="subtitle"><span class="pulse-dot"></span> <span id="moduleSubtitle">Real-time Multi-Agent
                            Monitoring Active</span></p>
                </div>
                <div class="header-right">
                    <div class="search-bar">
                        <input type="text" placeholder="Search threats, IPs, assets...">
                    </div>
                    <div id="connectionStatus" class="status-badge">
                        <span class="status-dot online"></span> SYSTEM ONLINE
                    </div>
                    <button id="refreshBtn" class="icon-btn">üîÑ</button>
                    <div class="avatar">JS</div>
                </div>
            </header>

            <!-- Overview Module -->
            <section id="overviewModule" class="module-section active">
                <section class="entity-risk-row">
                    <div class="risk-item">
                        <span class="risk-label">Resources</span>
                        <span class="risk-value" id="resCount">681</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-label">Identities</span>
                        <span class="risk-value" id="identCount">100</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-label">Machine Identities</span>
                        <span class="risk-value" id="machCount">150</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-label">Roles</span>
                        <span class="risk-value" id="roleCount">280</span>
                    </div>
                </section>

                <div class="dashboard-grid">
                    <div class="grid-col-1">
                        <div class="glass-card chart-card">
                            <div class="card-header">
                                <h4>Alerts Distribution</h4>
                            </div>
                            <div class="chart-container-donut"><canvas id="severityChart"></canvas></div>
                        </div>
                        <div class="glass-card stat-list-card">
                            <div class="card-header">
                                <h4>High-Risk Entities</h4>
                            </div>
                            <div class="entity-list" id="highRiskEntities">
                                <div class="mitre-item"><span>EC2_Instance_04</span><span class="badge"
                                        style="background:var(--danger)">CRITICAL</span></div>
                                <div class="mitre-item"><span>AdminUser_Root</span><span class="badge"
                                        style="background:var(--warning)">HIGH</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="grid-col-2">
                        <div class="glass-card chart-card">
                            <div class="card-header">
                                <h4>Alert Overview (Funnel)</h4>
                            </div>
                            <div class="funnel-visualization">
                                <div class="funnel-stage stage-1">
                                    <div class="stage-bar"></div><span class="stage-label">Raw Events: <span
                                            id="rawEventsCount">0</span></span>
                                </div>
                                <div class="funnel-stage stage-2">
                                    <div class="stage-bar"></div><span class="stage-label">Findings: <span
                                            id="findingsCount">0</span></span>
                                </div>
                                <div class="funnel-stage stage-3">
                                    <div class="stage-bar"></div><span class="stage-label">Correlated: <span
                                            id="correlatedCount">0</span></span>
                                </div>
                                <div class="funnel-stage stage-4">
                                    <div class="stage-bar"></div><span class="stage-label">Incidents: <span
                                            id="incidentsCount">0</span></span>
                                </div>
                            </div>
                        </div>
                        <div class="glass-card history-card">
                            <div class="card-header">
                                <h4>Threat Trend</h4>
                            </div>
                            <div class="chart-container-line"><canvas id="historyChart"></canvas></div>
                        </div>
                    </div>
                    <div class="grid-col-3">
                        <div class="glass-card mitre-card">
                            <div class="card-header">
                                <h4>MITRE ATT&CK Tactics</h4>
                            </div>
                            <div class="mitre-list" id="mitreTable"></div>
                        </div>
                        <div class="glass-card feed-card">
                            <div class="card-header">
                                <h4>Latest Threats</h4>
                            </div>
                            <div id="latestThreatsList" class="compact-feed"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Threat Matrix Module -->
            <section id="matrixModule" class="module-section">
                <div class="glass-card full-width">
                    <div class="card-header">
                        <h4>ThreadMatrix‚Ñ¢ Intelligence Grid</h4>
                    </div>
                    <div class="table-container">
                        <table class="premium-table">
                            <thead>
                                <tr>
                                    <th>Threat ID</th>
                                    <th>Source</th>
                                    <th>MITRE Technique</th>
                                    <th>Agent</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="matrixBody">
                                <!-- Populated via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Investigation Module -->
            <section id="investigationModule" class="module-section">
                <div class="investigation-layout">
                    <div class="glass-card graph-panel">
                        <div class="card-header">
                            <h4>Incident Relationship Graph</h4>
                        </div>
                        <div id="investigationGraph" class="graph-container"></div>
                    </div>
                    <div class="glass-card detail-panel">
                        <div class="card-header">
                            <h4>Entity Details</h4>
                        </div>
                        <div id="entityDetailContent" class="detail-content">
                            <p class="placeholder">Select a node to investigate...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Network Map Module -->
            <section id="mapModule" class="module-section">
                <div class="glass-card map-card">
                    <div class="card-header">
                        <h4>Live 3D Network Intelligence Map</h4>
                        <div class="map-controls">
                            <button class="ghost-btn" id="resetCamera">Reset View</button>
                            <button class="ghost-btn" id="toggleNodes">Toggle Labels</button>
                        </div>
                    </div>
                    <div id="threeJsContainer" class="three-container"></div>
                    <div class="map-legend">
                        <span class="legend-item"><span class="dot" style="background:var(--accent-primary)"></span>
                            Internal</span>
                        <span class="legend-item"><span class="dot" style="background:var(--danger)"></span>
                            Attacker</span>
                        <span class="legend-item"><span class="dot" style="background:var(--success)"></span>
                            Safe</span>
                    </div>
                </div>
            </section>

            <!-- Cloud Security Module -->
            <section id="cloudModule" class="module-section">
                <div class="cloud-grid">
                    <div class="glass-card cloud-card">
                        <span class="cloud-icon">AWS</span>
                        <h4>AWS Security Hub</h4>
                        <p class="cloud-stat">12 Findings</p>
                        <div class="sync-status"><span class="dot online"></span> Connected</div>
                    </div>
                    <div class="glass-card cloud-card">
                        <span class="cloud-icon">AZR</span>
                        <h4>Azure Sentinel</h4>
                        <p class="cloud-stat">5 Findings</p>
                        <div class="sync-status"><span class="dot online"></span> Connected</div>
                    </div>
                    <div class="glass-card cloud-card">
                        <span class="cloud-icon">GCP</span>
                        <h4>GCP Command Center</h4>
                        <p class="cloud-stat">0 Findings</p>
                        <div class="sync-status"><span class="dot online"></span> Connected</div>
                    </div>
                </div>
                <div class="glass-card full-width" style="margin-top:24px">
                    <div class="card-header">
                        <h4>Automated Remediation (Cloud Assistance)</h4>
                    </div>
                    <div id="cloudAiLogs" class="compact-feed">
                        <p class="loading-state">Syncing Cloud Assistance Agents...</p>
                    </div>
                </div>
            </section>

            <!-- Compliance Section -->
            <section id="complianceModule" class="module-section">
                <div class="compliance-grid">
                    <div class="glass-card">
                        <h4>SOC2 Type II</h4>
                        <div class="progress-track" style="height:10px; margin: 15px 0;">
                            <div class="progress-fill" style="width:94%"></div>
                        </div>
                        <p class="text-small">94% Compliant</p>
                    </div>
                    <div class="glass-card">
                        <h4>ISO 27001</h4>
                        <div class="progress-track" style="height:10px; margin: 15px 0;">
                            <div class="progress-fill" style="width:88%"></div>
                        </div>
                        <p class="text-small">88% Compliant</p>
                    </div>
                    <div class="glass-card">
                        <h4>GDPR</h4>
                        <div class="progress-track" style="height:10px; margin: 15px 0;">
                            <div class="progress-fill" style="width:100%"></div>
                        </div>
                        <p class="text-small">100% Compliant</p>
                    </div>
                </div>
            </section>

            <!-- Settings Module -->
            <section id="settingsModule" class="module-section">
                <div class="glass-card">
                    <h4>Agent Configuration</h4>
                    <div class="settings-list">
                        <div class="setting-item"><span>LLM Sensitivity</span><input type="range" min="0" max="100"
                                value="75"></div>
                        <div class="setting-item"><span>Scan Interval</span><select>
                                <option>Real-time</option>
                                <option>1 min</option>
                                <option>5 min</option>
                            </select></div>
                        <div class="setting-item"><span>Auto-Remediation</span><label class="switch"><input
                                    type="checkbox" checked><span class="slider"></span></label></div>
                    </div>
                </div>
            </section>

            <!-- Shared Interactive Zone (Only shows when needed or at bottom) -->
            <section class="interaction-zone">
                <div class="glass-card decision-panel">
                    <div class="card-header">
                        <h4>AI Decision Protocol</h4><span class="badge">LLM ACTIVE</span>
                    </div>
                    <div id="aiDecisions" class="decision-feed">
                        <p class="placeholder">Awaiting ingestion...</p>
                    </div>
                </div>
                <div class="glass-card injection-panel">
                    <div class="box-header">
                        <h4>Security Feed Injection</h4>
                        <div class="tabs">
                            <button id="textTab" class="tab-btn active">Logs</button>
                            <button id="emailTab" class="tab-btn">Email</button>
                            <button id="ipTab" class="tab-btn">Scan</button>
                        </div>
                    </div>
                    <div id="textInputArea" class="tab-content"><textarea id="logInput"
                            placeholder="SYSTEM_LOGS: [AUTH] failure..."></textarea><button id="analyzeBtn"
                            class="neon-btn">Execute Logs Analysis</button></div>
                    <div id="emailInputArea" class="tab-content" style="display: none;"><textarea id="emailInput"
                            placeholder="SUBJECT: Urgent..."></textarea><button id="analyzeEmailBtn"
                            class="neon-btn">Verify Email Trust</button></div>
                    <div id="ipInputArea" class="tab-content" style="display: none;"><textarea id="ipInput"
                            placeholder="NMAP_SCAN..."></textarea><button id="analyzeIpBtn" class="neon-btn">Scan
                            Vulnerability</button></div>
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="/static/dashboard.js"></script>
</body>

</html>